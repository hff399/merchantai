(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3663:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>o,routeModule:()=>x,tree:()=>d}),r(7314),r(9256),r(5866);var s=r(3191),a=r(8716),i=r(7922),n=r.n(i),l=r(5231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);r.d(t,c);let d=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,7314)),"/Users/leomishin/merchantai/admin/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,9256)),"/Users/leomishin/merchantai/admin/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],o=["/Users/leomishin/merchantai/admin/app/page.tsx"],m="/page",u={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},791:(e,t,r)=>{Promise.resolve().then(r.bind(r,3842)),Promise.resolve().then(r.bind(r,381))},2460:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},5303:()=>{},3842:(e,t,r)=>{"use strict";r.d(t,{default:()=>g});var s=r(326),a=r(434),i=r(5047),n=r(1135),l=r(1009),c=r(4319),d=r(4061),o=r(9436),m=r(3468),u=r(4975),x=r(617),h=r(8378);let p=[{name:"Дашборд",href:"/",icon:c.Z},{name:"Пользователи",href:"/users",icon:d.Z},{name:"Рассылки",href:"/broadcasts",icon:o.Z},{name:"Аутрич",href:"/outreach",icon:m.Z},{name:"Лиды",href:"/outreach/leads",icon:u.Z},{name:"Группы",href:"/outreach/groups",icon:x.Z}];function g(){let e=(0,i.usePathname)();return(0,s.jsxs)("div",{className:"w-64 bg-white border-r border-gray-200 flex flex-col",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"MerchantAI"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Admin Panel"})]}),s.jsx("nav",{className:"flex-1 p-4 space-y-1",children:p.map(t=>{let r=e===t.href||"/"!==t.href&&e.startsWith(t.href);return(0,s.jsxs)(a.default,{href:t.href,className:function(...e){return(0,l.m6)((0,n.W)(e))}("flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors",r?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:[s.jsx(t.icon,{className:"w-5 h-5"}),t.name]},t.name)})}),s.jsx("div",{className:"p-4 border-t border-gray-200",children:(0,s.jsxs)(a.default,{href:"/settings",className:"flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 hover:text-gray-900 transition-colors",children:[s.jsx(h.Z,{className:"w-5 h-5"}),"Настройки"]})})]})}},9256:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d,metadata:()=>c});var s=r(9510),a=r(8013),i=r.n(a);r(7272);var n=r(9125);let l=(0,r(8570).createProxy)(String.raw`/Users/leomishin/merchantai/admin/components/Sidebar.tsx#default`),c={title:"MerchantAI Admin",description:"Admin dashboard for MerchantAI Telegram Bot"};function d({children:e}){return s.jsx("html",{lang:"ru",children:(0,s.jsxs)("body",{className:i().className,children:[(0,s.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[s.jsx(l,{}),s.jsx("main",{className:"flex-1 overflow-auto",children:s.jsx("div",{className:"p-8",children:e})})]}),s.jsx(n.x7,{position:"top-right"})]})})}},7314:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var s=r(9510),a=r(5662),i=r(650),n=r(6707),l=r(6478);let c=(0,l.Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),d=(0,l.Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var o=r(4359),m=r(9987);let u=(0,l.Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);async function x(){let e=new Date().toISOString().split("T")[0],{count:t}=await a.p.from("users").select("*",{count:"exact",head:!0}),{count:r}=await a.p.from("users").select("*",{count:"exact",head:!0}).gte("created_at",e),{data:s}=await a.p.from("payments").select("amount").eq("status","succeeded"),i=s?.reduce((e,t)=>e+t.amount,0)||0,{data:n}=await a.p.from("payments").select("amount").eq("status","succeeded").gte("created_at",e),l=n?.reduce((e,t)=>e+t.amount,0)||0,{data:c}=await a.p.from("users").select("cards_created"),d=c?.reduce((e,t)=>e+t.cards_created,0)||0,{count:o}=await a.p.from("users").select("*",{count:"exact",head:!0}).not("referred_by","is",null),{count:m}=await a.p.from("outreach_campaigns").select("*",{count:"exact",head:!0}).eq("status","active"),{count:u}=await a.p.from("outreach_leads").select("*",{count:"exact",head:!0}).gte("created_at",e);return{totalUsers:t||0,todayUsers:r||0,totalRevenue:i,todayRevenue:l,totalCards:d,referralSignups:o||0,activeCampaigns:m||0,newLeads:u||0}}async function h(){let{data:e}=await a.p.from("users").select("*").order("created_at",{ascending:!1}).limit(5);return e||[]}async function p(){let{data:e}=await a.p.from("payments").select("*, users(username, first_name)").eq("status","succeeded").order("created_at",{ascending:!1}).limit(5);return e||[]}async function g(){let e=await x(),t=await h(),r=await p(),a=[{title:"Пользователей",value:(0,i.uf)(e.totalUsers),subtitle:`+${e.todayUsers} сегодня`,icon:n.Z,color:"text-blue-600 bg-blue-50"},{title:"Выручка",value:(0,i.xG)(e.totalRevenue),subtitle:`+${(0,i.xG)(e.todayRevenue)} сегодня`,icon:c,color:"text-green-600 bg-green-50"},{title:"Карточек создано",value:(0,i.uf)(e.totalCards),subtitle:"всего генераций",icon:d,color:"text-purple-600 bg-purple-50"},{title:"По рефералам",value:(0,i.uf)(e.referralSignups),subtitle:"регистраций",icon:o.Z,color:"text-orange-600 bg-orange-50"},{title:"Аутрич кампании",value:(0,i.uf)(e.activeCampaigns),subtitle:"активных",icon:m.Z,color:"text-pink-600 bg-pink-50"},{title:"Новых лидов",value:(0,i.uf)(e.newLeads),subtitle:"сегодня",icon:u,color:"text-cyan-600 bg-cyan-50"}];return(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Дашборд"}),s.jsx("p",{className:"text-gray-500",children:"Обзор ключевых метрик"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(e=>s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`p-3 rounded-lg ${e.color}`,children:s.jsx(e.icon,{className:"w-6 h-6"})}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:e.title}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.value}),s.jsx("p",{className:"text-sm text-gray-400",children:e.subtitle})]})]})},e.title))}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Новые пользователи"})}),s.jsx("div",{className:"divide-y divide-gray-100",children:t.map(e=>(0,s.jsxs)("div",{className:"p-4 flex items-center gap-4",children:[s.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-gray-600 font-medium",children:(e.first_name||e.username||"?")[0].toUpperCase()})}),(0,s.jsxs)("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium text-gray-900",children:e.first_name||e.username||"Без имени"}),s.jsx("p",{className:"text-sm text-gray-500",children:e.username?`@${e.username}`:`ID: ${e.telegram_id}`})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[e.credits," токенов"]}),s.jsx("p",{className:"text-xs text-gray-500",children:e.utm_source&&`via ${e.utm_source}`})]})]},e.id))})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Последние платежи"})}),s.jsx("div",{className:"divide-y divide-gray-100",children:r.map(e=>(0,s.jsxs)("div",{className:"p-4 flex items-center gap-4",children:[s.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:s.jsx(c,{className:"w-5 h-5 text-green-600"})}),(0,s.jsxs)("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium text-gray-900",children:e.users?.first_name||e.users?.username||"Пользователь"}),s.jsx("p",{className:"text-sm text-gray-500",children:e.plan})]}),s.jsx("div",{className:"text-right",children:(0,s.jsxs)("p",{className:"text-sm font-medium text-green-600",children:["+",(0,i.xG)(e.amount)]})})]},e.id))})]})]})]})}},5662:(e,t,r)=>{"use strict";r.d(t,{p:()=>s});let s=(0,r(7857).eI)("https://lfeqwqcbhjkedclxihlw.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})},650:(e,t,r)=>{"use strict";r.d(t,{SY:()=>l,p6:()=>n,uf:()=>d,xG:()=>c});var s=r(3597),a=r(4269),i=r(6611);function n(e){return(0,s.Z)(new Date(e),"dd.MM.yyyy HH:mm",{locale:i.Z})}function l(e){return(0,a.Z)(new Date(e),{addSuffix:!0,locale:i.Z})}function c(e,t="RUB"){return new Intl.NumberFormat("ru-RU",{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}function d(e){return new Intl.NumberFormat("ru-RU").format(e)}},9987:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(6478).Z)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},4359:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(6478).Z)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},6707:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(6478).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},7272:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,857,223,377],()=>r(3663));module.exports=s})();