(()=>{var e={};e.id=741,e.ids=[741],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8732:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>h,originalPathname:()=>x,pages:()=>d,routeModule:()=>m,tree:()=>o}),r(6612),r(9256),r(5866);var s=r(3191),a=r(8716),n=r(7922),l=r.n(n),i=r(5231),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);r.d(t,c);let o=["",{children:["outreach",{children:["groups",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,6612)),"/Users/leomishin/merchantai/admin/app/outreach/groups/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,9256)),"/Users/leomishin/merchantai/admin/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/leomishin/merchantai/admin/app/outreach/groups/page.tsx"],x="/outreach/groups/page",h={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/outreach/groups/page",pathname:"/outreach/groups",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},9034:(e,t,r)=>{Promise.resolve().then(r.bind(r,5954)),Promise.resolve().then(r.t.bind(r,9404,23))},791:(e,t,r)=>{Promise.resolve().then(r.bind(r,3842)),Promise.resolve().then(r.bind(r,381))},2460:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},5954:(e,t,r)=>{"use strict";r.d(t,{default:()=>h});var s=r(326),a=r(7577),n=r(5047),l=r(381),i=r(231),c=r(6557);let o=(0,c.Z)("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),d=(0,c.Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);var x=r(8091);function h({group:e}){let t=(0,n.useRouter)(),[r,c]=(0,a.useState)(!1),[h,m]=(0,a.useState)(!1),u=async()=>{m(!0);try{let r="active"===e.status?"paused":"active";(await fetch("/api/outreach/groups/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({groupId:e.id,status:r})})).ok?(l.ZP.success("active"===r?"Группа активирована":"Группа приостановлена"),t.refresh()):l.ZP.error("Ошибка")}catch(e){l.ZP.error("Ошибка")}finally{m(!1),c(!1)}},p=async()=>{if(confirm(`Удалить группу "${e.title}"?`)){m(!0);try{(await fetch("/api/outreach/groups/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({groupId:e.id})})).ok?(l.ZP.success("Группа удалена"),t.refresh()):l.ZP.error("Ошибка")}catch(e){l.ZP.error("Ошибка")}finally{m(!1),c(!1)}}};return(0,s.jsxs)("div",{className:"relative",children:[s.jsx("button",{onClick:()=>c(!r),className:"p-2 hover:bg-gray-100 rounded-lg",disabled:h,children:s.jsx(i.Z,{className:"w-5 h-5 text-gray-500"})}),r&&(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>c(!1)}),(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-20",children:[s.jsx("button",{onClick:u,className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:"active"===e.status?(0,s.jsxs)(s.Fragment,{children:[s.jsx(o,{className:"w-4 h-4"}),"Приостановить"]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(d,{className:"w-4 h-4"}),"Активировать"]})}),s.jsx("hr",{className:"my-1"}),(0,s.jsxs)("button",{onClick:p,className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2 text-red-600",children:[s.jsx(x.Z,{className:"w-4 h-4"}),"Удалить"]})]})]})]})}},3842:(e,t,r)=>{"use strict";r.d(t,{default:()=>g});var s=r(326),a=r(434),n=r(5047),l=r(1135),i=r(1009),c=r(4319),o=r(4061),d=r(9436),x=r(3468),h=r(4975),m=r(617),u=r(8378);let p=[{name:"Дашборд",href:"/",icon:c.Z},{name:"Пользователи",href:"/users",icon:o.Z},{name:"Рассылки",href:"/broadcasts",icon:d.Z},{name:"Аутрич",href:"/outreach",icon:x.Z},{name:"Лиды",href:"/outreach/leads",icon:h.Z},{name:"Группы",href:"/outreach/groups",icon:m.Z}];function g(){let e=(0,n.usePathname)();return(0,s.jsxs)("div",{className:"w-64 bg-white border-r border-gray-200 flex flex-col",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"MerchantAI"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Admin Panel"})]}),s.jsx("nav",{className:"flex-1 p-4 space-y-1",children:p.map(t=>{let r=e===t.href||"/"!==t.href&&e.startsWith(t.href);return(0,s.jsxs)(a.default,{href:t.href,className:function(...e){return(0,i.m6)((0,l.W)(e))}("flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors",r?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:[s.jsx(t.icon,{className:"w-5 h-5"}),t.name]},t.name)})}),s.jsx("div",{className:"p-4 border-t border-gray-200",children:(0,s.jsxs)(a.default,{href:"/settings",className:"flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 hover:text-gray-900 transition-colors",children:[s.jsx(u.Z,{className:"w-5 h-5"}),"Настройки"]})})]})}},231:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(6557).Z)("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},8091:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(6557).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},9256:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,metadata:()=>c});var s=r(9510),a=r(8013),n=r.n(a);r(7272);var l=r(9125);let i=(0,r(8570).createProxy)(String.raw`/Users/leomishin/merchantai/admin/components/Sidebar.tsx#default`),c={title:"MerchantAI Admin",description:"Admin dashboard for MerchantAI Telegram Bot"};function o({children:e}){return s.jsx("html",{lang:"ru",children:(0,s.jsxs)("body",{className:n().className,children:[(0,s.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[s.jsx(i,{}),s.jsx("main",{className:"flex-1 overflow-auto",children:s.jsx("div",{className:"p-8",children:e})})]}),s.jsx(l.x7,{position:"top-right"})]})})}},6612:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var s=r(9510),a=r(5662),n=r(650),l=r(7371),i=r(4126),c=r(1242),o=r(86);let d=(0,r(8570).createProxy)(String.raw`/Users/leomishin/merchantai/admin/app/outreach/groups/GroupActions.tsx#default`);async function x(e){let t=parseInt(e.page||"1"),r=(t-1)*20,s=a.p.from("outreach_groups").select("*",{count:"exact"}).order("created_at",{ascending:!1});e.category&&(s=s.eq("category",e.category));let{data:n,count:l}=await s.range(r,r+20-1);return{groups:n||[],total:l||0,page:t,totalPages:Math.ceil((l||0)/20)}}async function h(){let{data:e}=await a.p.from("outreach_groups").select("category").not("category","is",null),t=new Set;return e?.forEach(e=>e.category&&t.add(e.category)),Array.from(t)}async function m({searchParams:e}){let{groups:t,total:r,page:a,totalPages:m}=await x(e),u=await h();return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Группы для аутрича"}),(0,s.jsxs)("p",{className:"text-gray-500",children:["Всего: ",r]})]}),(0,s.jsxs)(l.default,{href:"/outreach/groups/new",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[s.jsx(i.Z,{className:"w-4 h-4"}),"Добавить группу"]})]}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:(0,s.jsxs)("form",{className:"flex gap-4",children:[(0,s.jsxs)("select",{name:"category",defaultValue:e.category,className:"px-4 py-2 border border-gray-200 rounded-lg",children:[s.jsx("option",{value:"",children:"Все категории"}),u.map(e=>s.jsx("option",{value:e,children:e},e))]}),s.jsx("button",{type:"submit",className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Применить"})]})}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:0===t.length?(0,s.jsxs)("div",{className:"p-12 text-center",children:[s.jsx(c.Z,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Нет групп"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"Добавьте группы для аутрича"})]}):(0,s.jsxs)("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Группа"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Категория"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Участников"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Статус"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Добавлено"}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Действия"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:t.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:s.jsx(c.Z,{className:"w-5 h-5 text-purple-600"})}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:e.title}),e.username&&(0,s.jsxs)("a",{href:`https://t.me/${e.username}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:["@",e.username,s.jsx(o.Z,{className:"w-3 h-3"})]})]})]})}),s.jsx("td",{className:"px-6 py-4",children:e.category&&s.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-sm rounded",children:e.category})}),s.jsx("td",{className:"px-6 py-4 text-gray-600",children:e.member_count?(0,n.uf)(e.member_count):"-"}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:`px-2 py-1 text-sm rounded ${"active"===e.status?"bg-green-100 text-green-700":"paused"===e.status?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:"active"===e.status?"Активна":"paused"===e.status?"Пауза":"Забанена"})}),s.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:(0,n.p6)(e.created_at)}),s.jsx("td",{className:"px-6 py-4 text-right",children:s.jsx(d,{group:e})})]},e.id))})]})}),m>1&&(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[a>1&&s.jsx(l.default,{href:`/outreach/groups?page=${a-1}`,className:"px-4 py-2 border border-gray-200 rounded-lg hover:bg-gray-50",children:"Назад"}),(0,s.jsxs)("span",{className:"px-4 py-2 text-gray-600",children:["Страница ",a," из ",m]}),a<m&&s.jsx(l.default,{href:`/outreach/groups?page=${a+1}`,className:"px-4 py-2 border border-gray-200 rounded-lg hover:bg-gray-50",children:"Вперёд"})]})]})}},5662:(e,t,r)=>{"use strict";r.d(t,{p:()=>s});let s=(0,r(7857).eI)("https://lfeqwqcbhjkedclxihlw.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})},650:(e,t,r)=>{"use strict";r.d(t,{SY:()=>i,p6:()=>l,uf:()=>o,xG:()=>c});var s=r(3597),a=r(4269),n=r(6611);function l(e){return(0,s.Z)(new Date(e),"dd.MM.yyyy HH:mm",{locale:n.Z})}function i(e){return(0,a.Z)(new Date(e),{addSuffix:!0,locale:n.Z})}function c(e,t="RUB"){return new Intl.NumberFormat("ru-RU",{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}function o(e){return new Intl.NumberFormat("ru-RU").format(e)}},86:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(6478).Z)("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]])},1242:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(6478).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},4126:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(6478).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7371:(e,t,r)=>{"use strict";r.d(t,{default:()=>a.a});var s=r(1812),a=r.n(s)},1812:(e,t,r)=>{"use strict";let{createProxy:s}=r(8570);e.exports=s("/Users/leomishin/merchantai/admin/node_modules/next/dist/client/link.js")},7272:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,857,223,377],()=>r(8732));module.exports=s})();