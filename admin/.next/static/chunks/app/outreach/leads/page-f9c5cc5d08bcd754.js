(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[873],{6298:function(e,t,s){Promise.resolve().then(s.bind(s,8959)),Promise.resolve().then(s.t.bind(s,2972,23))},8959:function(e,t,s){"use strict";s.d(t,{default:function(){return f}});var r=s(7437),a=s(2265),l=s(9376),c=s(9064),n=s(7684),i=s(3417),o=s(4743),x=s(9763);let d=(0,x.Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),u=(0,x.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var h=s(2489);function f(e){let{lead:t}=e,s=(0,l.useRouter)(),[x,f]=(0,a.useState)(!1),[p,y]=(0,a.useState)(!1),m=async e=>{y(!0);try{(await fetch("/api/outreach/leads/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leadId:t.id,status:e})})).ok?(c.ZP.success("Статус обновлён"),s.refresh()):c.ZP.error("Ошибка")}catch(e){c.ZP.error("Ошибка")}finally{y(!1),f(!1)}},g=async()=>{y(!0);try{let e=await fetch("/api/outreach/leads/send-dm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leadId:t.id})});if(e.ok)c.ZP.success("DM отправлен"),s.refresh();else{let t=await e.json();c.ZP.error(t.error||"Ошибка")}}catch(e){c.ZP.error("Ошибка")}finally{y(!1),f(!1)}};return(0,r.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,r.jsx)("button",{onClick:()=>f(!x),className:"p-2 hover:bg-gray-100 rounded-lg",disabled:p,children:(0,r.jsx)(n.Z,{className:"w-5 h-5 text-gray-500"})}),x&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>f(!1)}),(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 z-20",children:[t.username&&(0,r.jsxs)("a",{href:"https://t.me/".concat(t.username),target:"_blank",rel:"noopener noreferrer",className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[(0,r.jsx)(i.Z,{className:"w-4 h-4"}),"Открыть в Telegram"]}),!t.dm_sent&&(0,r.jsxs)("button",{onClick:g,className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[(0,r.jsx)(o.Z,{className:"w-4 h-4"}),"Отправить DM"]}),(0,r.jsx)("hr",{className:"my-1"}),(0,r.jsx)("p",{className:"px-4 py-1 text-xs text-gray-400 uppercase",children:"Изменить статус"}),(0,r.jsxs)("button",{onClick:()=>m("contacted"),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[(0,r.jsx)(o.Z,{className:"w-4 h-4 text-yellow-500"}),"Связались"]}),(0,r.jsxs)("button",{onClick:()=>m("replied"),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[(0,r.jsx)(i.Z,{className:"w-4 h-4 text-green-500"}),"Ответил"]}),(0,r.jsxs)("button",{onClick:()=>m("qualified"),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[(0,r.jsx)(d,{className:"w-4 h-4 text-purple-500"}),"Квалифицирован"]}),(0,r.jsxs)("button",{onClick:()=>m("converted"),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[(0,r.jsx)(u,{className:"w-4 h-4 text-emerald-500"}),"Конвертирован"]}),(0,r.jsxs)("button",{onClick:()=>m("rejected"),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2 text-red-600",children:[(0,r.jsx)(h.Z,{className:"w-4 h-4"}),"Отклонить"]})]})]})]})}},3417:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},7684:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},4743:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},2489:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}},function(e){e.O(0,[972,952,971,117,744],function(){return e(e.s=6298)}),_N_E=e.O()}]);